version: 1
shathel-stack:
  deployName: proxy
  enrichers:
    addNetwork:
        target: ALL
        inline: |
          def services = compose.findServicesWithLabels("com.df.notify","true")
          if (!services.isEmpty()){
              compose.addExternalNetwork("proxy_network")
              services.each {
                  compose.addNetworkToService(it, "proxy_network")
                  if (it.deploy.labels['com.df.usersSecret'] == 'monitoring') {
                          it.deploy.labels['com.df.usersPassEncrypted'] = 'true'
                  }
              }
          }
